<div class="mx-auto flex w-full max-w-5xl flex-col gap-6">
  <div class="flex items-center justify-between">
    <div class="flex flex-col gap-1">
      <h2 class="text-3xl font-bold tracking-tight">Review Flashcards</h2>
      <p class="text-muted-foreground">
        Review and edit your generated flashcards before exporting.
      </p>
    </div>
    <button (click)="openExportModal()" appButton>Export to Anki</button>
  </div>

  <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
    @for (card of flashcards(); track card.word) {
      <div
        class="relative cursor-pointer rounded-lg hover:ring-2 hover:ring-border-active hover:ring-offset-2 hover:ring-offset-background"
        [attr.aria-label]="'Edit flashcard for ' + card.word"
        (click)="openEditor(card)"
        (keyup.enter)="openEditor(card)"
        tabindex="0"
        role="button"
      >
        <app-flashcard-preview [flashcard]="card" [compact]="true"></app-flashcard-preview>

        <div
          class="absolute inset-0 z-10 flex items-center justify-center rounded-xl bg-black/40 opacity-0 transition-opacity duration-200 hover:opacity-100"
        >
          <div
            class="flex items-center justify-center rounded-full bg-background p-2 text-foreground shadow-lg"
          >
            <lucide-icon class="size-4" [img]="ICONS.Pencil" />
          </div>
        </div>
      </div>
    }
  </div>

  <!-- Editor Dialog -->
  <lib-modal [isOpen]="!!editingCard()" (closeModal)="closeEditor()" size="lg">
    <app-flashcard-editor
      [flashcard]="editingCard()"
      (save)="saveCard($event)"
      (cancelEdit)="closeEditor()"
    />
  </lib-modal>

  <!-- Export Dialog -->
  <lib-modal [isOpen]="showExportDialog()" (closeModal)="showExportDialog.set(false)" size="md">
    <app-export-flashcards-modal
      [flashcards]="flashcards()"
      (cancelExport)="showExportDialog.set(false)"
    />
  </lib-modal>
</div>
